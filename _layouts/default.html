<!DOCTYPE html>
<html lang="en">

{% include head.html %}

<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    {% include nav.html %}
    
    {{ content }}

    {% include footer.html %}


    <!-- 关键：手动注入 Mermaid 脚本（放在 content 之后，确保代码块已渲染） -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.1/dist/mermaid.min.js"></script>
    <script>
      // 等待 Jekyll 完全渲染页面后再初始化 Mermaid
      window.addEventListener('load', function() {
        // 强制查找所有可能的 mermaid 代码块（处理类名可能的变体）
        const codeBlocks = document.querySelectorAll('pre code[class*="language-mermaid"], pre code[class*="mermaid"]');
        if (codeBlocks.length > 0 && window.mermaid) {
          mermaid.initialize({
            startOnLoad: false,  // 禁用自动加载，手动触发
            theme: 'default'
          });
          // 手动渲染所有找到的代码块
          codeBlocks.forEach(block => {
            mermaid.render(`mermaid-${Date.now()}`, block.textContent, (svgCode) => {
              block.parentNode.innerHTML = svgCode;  // 用 SVG 替换原代码块
            });
          });
        }
      });
    </script>
    
<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>